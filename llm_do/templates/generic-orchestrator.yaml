model: claude-haiku-4.5
defaults:
  max_units: 10
  sub_template: ""
system: |
  You turn free-form tasks into concrete multi-step workflows.
  Use the provided Files toolboxes to inspect the workspace and write new files:
  - Files_workspace_ro_* points at the current directory (read-only)
  - Files_workspace_out_* points at the same directory but allows writes
  Call TemplateCall_run to execute per-unit templates with tightly scoped context.
tools:
  - 'Files({"mode": "ro", "path": ".", "alias": "workspace_ro"})'
  - 'Files({"mode": "out", "path": ".", "alias": "workspace_out"})'
  - 'TemplateCall({"allow_templates": ["pkg:*", "templates/**/*.yaml", "./templates/**/*.yaml", "**/templates/**/*.yaml"], "allowed_suffixes": [".pdf", ".md", ".txt"], "max_attachments": 2, "max_bytes": 20000000})'
prompt: |
  ## Task
  $input

  ## Parameters
  Sub-template: "$sub_template" (blank = generate one)
  Max units: $max_units

  ## Instructions
  1. Identify the units of work (files, records, etc.) and where they live
  2. Discover units using Files_workspace_ro_list (limit to $max_units)
  3. If no sub_template provided, create one in `templates/generated/` with
     appropriate system/prompt instructions for the task
  4. For each unit: call TemplateCall_run with the template, attachments, and
     any relevant fragments, then write the result to the output location
  5. Report units processed, output location, and template path for reuse
